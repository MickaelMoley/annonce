{% extends 'base.html.twig' %}
 {% block title %}Annonce {{ annonce.title }}{% endblock %}
{% block head %}
    {{ parent() }}

    <meta name="description" content="Véhicule {{ annonce.make }} {{ annonce.model }} vendu par {{ annonce.dealer.dealerName }}
    - Localisation : {{ annonce.adress.city }}
    - Kilométrage : {{ annonce.mileage }}
    - Référence : {{ annonce.dealerRef }}
    - Couleur extérieur : {{ annonce.exteriorColor }}
    - Carburant : {{ annonce.fuelType }}
    - Transmission : {{ annonce.transmission }}">
    <meta name="keywords" content="{{ annonce.dealer.dealerName }}, {{ annonce.dealer.dealerPhone }}, vehicule, {{ annonce.make }}, {{ annonce.model }}, {{ annonce.dealerRef }}">
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link async rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.css" />
    <link async rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.css">
    <link rel="stylesheet" href="{{ asset('assets/css/swiper.css') }}">
    <style>
        .swiper-container {
            width: 100%;
            height: 10rem;
            margin-left: auto;
            margin-right: auto;
        }

        .swiper-slide {
            background-size: cover;
            background-position: center;
        }

        .gallery-top {
            height: 250px;
            width: 100%;
        }

        .gallery-thumbs {
            height: 100px;
            box-sizing: border-box;
            padding: 10px 0;
        }

        @media (min-width: 768px) {
            .gallery-top {
                height: 450px;
                width: 100%;
            }

            .gallery-thumbs {
                height: 150px;
                box-sizing: border-box;
                padding: 10px 0;
            }
        }

        .gallery-thumbs .swiper-slide {
            height: 100%;
            opacity: 0.4;
        }

        .gallery-thumbs .swiper-slide-thumb-active {
            opacity: 1;
        }
    </style>

{% endblock %}

{% block body %}
    <div class="hero-wrap hero-wrap-2 d-none d-lg-block"
         style="background-image: url({{ asset('assets/images/bg.jpg') }});background-position: 50% 80%; height: 110px !important;"
         data-stellar-background-ratio="0.5">
        <div class="overlay"></div>
        <div class="container">
            <div class="row no-gutters slider-text align-items-end justify-content-start">
                <div class="col-md-12 ftco-animate text-center mb-5">
                    <p class="breadcrumbs mb-0">
                        <span class="mr-3">
                            <a href="index.html">Home <i class="ion-ios-arrow-forward"></i></a>
                        </span>
                        <span>Blog</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <section class="d-none d-lg-block">
        <div class="container">
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <nav aria-label="breadcrumb" class="mt-4">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="{{ path('home') }}">Accueil</a></li>
                                    <li class="breadcrumb-item"><a href="{{ path('annonces') }}">Annonces</a></li>
                                    <li class="breadcrumb-item" aria-current="page"><a
                                                href="{{ path('annonces', { 'make': annonce.make|lower }) }}"
                                                class="text-dark">{{ annonce.make }}</a></li>
                                    <li class="breadcrumb-item active" aria-current="page"><a
                                                href="{{ path('annonces', { 'model': annonce.model|lower }) }}"
                                                class="text-dark">{{ annonce.model }}</a></li>
                                </ol>
                            </nav>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class=" ftco-degree-bg">
        <div class="container">

            <div class="row">
                <div class="col-lg-8 ftco-animate">
                    {#
                    {% for message in app.flashes('success') %}
                        <div class="alert alert-success">
                            {{ message }}
                        </div>
                    {% endfor %}
                    #}
                    <div class="swiper-container gallery-top" id="annonce-collection-image">
                        <div class="swiper-wrapper my-gallery" itemscope itemtype="http://schema.org/ImageGallery">{% if annonce.image[0].url is iterable %}
                                {% for image in annonce.image %}

                                    {% if image is not empty %}
                                        <div id="{{ loop.index }}" class="swiper-slide image-popup" href="{{ image.url[0] }}"
                                             style="background-image:url({{ image.url[0] }})" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">

                                        </div>
                                    {% endif %}




                                {% endfor %}
                            {% else %}

                                {% for image in annonce.image %}
                                    <div class="swiper-slide" style="background-image:url({{ image.url }})">

                                    </div>

                                {% endfor %}
                            {% endif %}
                        </div>
                        <div class="swiper-button-next swiper-button-white"></div>
                        <div class="swiper-button-prev swiper-button-white"></div>
                    </div>
                    <div class="swiper-container gallery-thumbs">
                        <div class="swiper-wrapper">
                            {% if annonce.image[0].url is iterable %}
                                {% for image in annonce.image %}

                                    <div class="swiper-slide"
                                         style="background-image:url({{ image.url[0] }})">

                                    </div>
                                {% endfor %}

                            {% else %}
                                {% for image in annonce.image %}
                                    <div class="swiper-slide" style="background-image:url({{ image.url }})">

                                    </div>

                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                    <h1 class="mb-3 font-weight-medium a-title">{{ annonce.title }}</h1>

                    <h4 class="text-primary">{% if annonce.price is not empty %} {{ annonce.price | number_format(2,'.',',') }} € {% else %} Le prix n'a pas été défini. Contacter le vendeur {% endif %} </h4>
                    <div class="d-flex justify-content-between align-content-center align-items-center align-self-center">
                        <p style="color: #2D3748; margin-bottom: 0"><i
                                    class="fa fa-map-marker mr-2"></i>{% if annonce.adress is not empty %}{{ annonce.adress['city'] }}, {{ annonce.adress['postal_code'] }}{% else %} Non spécifié*{% endif %}
                        </p>
                        <a href="#contact_dealer" class="btn btn-primary d-lg-none"><i class="fa fa-envelope mr-3"></i>Message</a>
                    </div>
                    <hr>
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="description-tab" data-toggle="tab" href="#description"
                               role="tab"
                               aria-controls="description" aria-selected="true" title="Voir les caractéristiques">Caractéristiques</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="options-tab" data-toggle="tab" href="#options" role="tab"
                               aria-controls="options" aria-selected="false" title="Voir les options">Options</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="note-tab" data-toggle="tab" href="#note" role="tab"
                               aria-controls="note" aria-selected="false" title="Voir la note du vendeur">Note de
                                vendeur</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="localisation-tab" data-toggle="tab" href="#localisation" role="tab"
                               aria-controls="localisation" aria-selected="false" title="Voir la localisation">Localisation</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="description" role="tabpanel"
                             aria-labelledby="description-tab">
                            <div class="row mt-3">
                                <div class="col-12 col-lg-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between">
                                    <span class="text-dark"><i
                                                class="fas fa-car-side mr-2"></i>Catégorie</span><span> {% if annonce.bodyStyle is not empty %} {{ annonce.bodyStyle|capitalize }} {% else %} Non spécifié* {% endif %} </span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-car mr-2"></i>Marque</span><span
                                                    class="text-muted">{% if annonce.make is not empty %}{{ annonce.make|capitalize }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-car-alt mr-2"></i>Modèle</span><span>{% if annonce.model is not empty %}{{ annonce.model|capitalize }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-hashtag mr-2"></i>Référence</span><span>{{ annonce.vehicleId }}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between">
                                <span class="text-dark">
                                    <i class="fas fa-calendar-day mr-2"></i>Mise en circulation&nbsp;</span><span>{% if annonce.year is not empty %}{{ annonce.year }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-12 col-lg-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-gas-pump mr-2"></i>Carburant&nbsp;</span><span>{% if annonce.fuelType is not empty %}{{ annonce.fuelType|capitalize }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-road mr-2"></i>Kilométrage</span><span>{% if annonce.mileage is not empty %}{{ annonce.mileage | number_format(0,'',' ') }} km{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-cog mr-2"></i>Boîte</span><span>{% if annonce.transmission is not empty %}{{ annonce.transmission|capitalize }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between"><span
                                                    class="text-dark"><i
                                                        class="fas fa-palette mr-2"></i>Couleur extérieur</span><span>{% if annonce.exteriorColor is not empty %}{{ annonce.exteriorColor }}{% else %} Non spécifié*{% endif %}</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="options" role="tabpanel" aria-labelledby="options-tab">
                            <div class="row">

                                {% set currentFeature = 0 %}
                                {% set limitPerColumn = annonce.features|length / 4 %}
                                {% if limitPerColumn  < 10 %}
                                    {% set limitPerColumn = annonce.features|length %}
                                {% endif %}
                                {% for feature in annonce.features %}
                                    {% if currentFeature == 0 %}

                                        <div class="col-12 col-md-6 col-lg-6">
                                        <ul class="list-unstyled text-dark p-3">

                                    {% endif %}

                                    <li><i class="fas fa-check mr-2"></i>{{ feature|capitalize }}</li>

                                    {% set currentFeature = currentFeature + 1 %}

                                    {% if currentFeature >= limitPerColumn or  loop.index == annonce.features|length %}

                                        {% set currentFeature = 0 %}

                                        </ul>
                                        </div>
                                    {% endif %}

                                {% endfor %}

                            </div>
                        </div>
                        <div class="tab-pane fade p-3 text-dark" id="note" role="tabpanel" aria-labelledby="note-tab">
                            {{ annonce.description|raw }}
                        </div>
                        <div class="tab-pane fade p-3 text-dark" id="localisation" role="tabpanel"
                             aria-labelledby="localisation-tab">
                            <iframe
                                    width="100%"
                                    height="500px"
                                    frameborder="0"
                                    scrolling="no"
                                    marginheight="0"
                                    marginwidth="0"
                                    src="https://maps.google.com/maps?q={{ annonce.latitude }},{{ annonce.longitude }}&hl=fr&z=14&amp;output=embed"
                            >
                            </iframe>
                        </div>
                    </div>
                    <hr>{% set currentPath = path(app.request.attributes.get('_route'),
                        app.request.attributes.get('_route_params')) %}
                    <div class="d-flex justify-content-between">
                        <a href="javascript:window.print()" class="mr-3  text-body"><i class="fa fa-print mr-2 "
                                                                                       title="Imprimer l'annonce"></i>Imprimer
                            l'annonce</a>
                        <a class="text-body"
                           href="mailto:?subject=Annonce%20de%20Pubauto%20-%20{{ annonce.make }}%20{{ annonce.model }}&body=Bonjour,je%20t'envoie%20l'annonce%20de%20PubAuto.Jete%20un%20coup%20d'oeil.&#10;Voici%20le%20lien%20:{{ app.request.getSchemeAndHttpHost ~ annonce.slug }}"><i
                                    class="fa fa-envelope mr-2"></i>Partager par mail</a>
                    </div>
                    <hr>
                </div>
                <br>
                <div id="contact_dealer" class="col-lg-4 mt-lg-0 mt-5 sidebar ftco-animate border-1">
                    <div class="sidebar-box">
                        <div class="card  shadow-sm" style="border: none;border-top: 4px #ed2f31 solid;">
                            <div class="card-header">
                                <div class="media">


                                    {% set x = annonce.dealer.dealerName|split(' ')[0] %}
                                    {% set isPartenaire = (x| lower == 'partenaire') ? 1 : 0 %}

                                    {% if isPartenaire == true%}
                                        <img src="{{ asset('assets/images/partenaire-vroomiz.png') }}"
                                             class="align-self-start mr-3 img-thumbnail" width="50"
                                             alt="Image avatar {{ annonce.dealer.dealerName }}">
                                    {% endif %}
                                    <div class="media-body">
                                        <a href="{{ path('dealer_store', { 'slug': annonce.dealer.slug}) }}"
                                           data-toggle="tooltip" data-placement="top" title="Voir la boutique">
                                            <h5 class="mt-0">{{ annonce.dealer.dealerName }}</h5>
                                            <h6 class="font-weight-medium">{{ annonce.dealer.annonces|length }} annonces
                                                en lignes</h6>

                                        </a>
                                    </div>
                                </div>
                            </div>
                            <hr class="mx-4">
                            <div class="card-body">
                                {{ form_start(contact) }}
                                <div class="form-group">
                                    {{ form_label(contact.email, "Adresse mail") }}
                                    {{ form_errors(contact.email) }}
                                    {{ form_widget(contact.email, { 'attr':{}}) }}
                                    {{ form_help(contact.email) }}
                                </div>
                                <div class="form-group">
                                    {{ form_label(contact.phone, "Téléphone") }}
                                    {{ form_errors(contact.phone) }}
                                    {{ form_widget(contact.phone, { 'attr':{}}) }}
                                    {{ form_help(contact.phone) }}
                                </div>
                                <div class="form-group">
                                    {{ form_label(contact.message, "Message") }}
                                    {{ form_errors(contact.message) }}
                                    {{ form_widget(contact.message, { 'attr':{'rows': 6, 'placeholder': "Bonjour, je suis intéressé par ce véhicule. Je souhaite prendre contact avec vous."}}) }}
                                    {{ form_help(contact.message) }}
                                </div>
                                {{ form_rest(contact) }}

                                {% for message in app.flashes('success') %}
                                   <div class="text-info mb-3">
                                       <h6><b>Info : </b></h6>
                                       <p class=text-info"><i class="fa fa-info-circle mr-2"></i> Votre message a bien été envoyé. On va vous recontacter par l'un des informations que vous avez renseignés.</p>
                                   </div>
                                {% endfor %}
                                <button type="submit" class="btn btn-block btn-primary" style="padding: 1rem 0.75rem"><i
                                            class="fa fa-envelope mr-2"></i>Envoyer mon message
                                </button>
                                {{ form_end(contact) }}
                            </div>
                        </div>

                        <hr>

                    </div>

                    <div class="sidebar-box ftco-animate">
                        <h3 class="heading-3">Annonces récents</h3>


                        {% for annonce in annonces %}
                            <div class="block-21 mb-4 d-flex">
                                <a class="blog-img mr-4"
                                   style="background-image: url({% if annonce.image[0].url is iterable %}{{ annonce.image[0].url[0] }}{% else %} {{ annonce.image[0].url }} {% endif %});"></a>
                                <div class="text">
                                    <h3 class="heading"><a
                                                href="{{ path('annonce', {'slug' : annonce.slug}) }}">{{ annonce.title }}</a>
                                    </h3>
                                    <div class="meta">
                                        <div>
                                            <a href="{{ path('annonces', { 'minKilometer': annonce.mileage}) }}"><{% if annonce.mileage is not empty %}i
                                                        class="fas fa-road "></i> {{ annonce.mileage | number_format(0,'',' ') }}
                                                km{% else %} Non spécifié*{% endif %}</a></div>
                                        <div>
                                            <a href="{{ path('annonces', { 'transmission' : annonce.transmission|lower}) }}">{% if annonce.transmission is not empty %}
                                                    <i class="fas fa-cogs "></i> {{ annonce.transmission }}{% else %} Non spécifié*{% endif %}
                                            </a></div>
                                        <div>
                                            <a href="{{ path('annonces', { 'minYear' : annonce.year, 'maxYear': annonce.year}) }}">{% if annonce.year is not empty %}
                                                    <i class="fas fa-calendar "></i> {{ annonce.year }}{% else %} Non spécifié*{% endif %}
                                            </a></div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}


                    </div>

                </div>

            </div>
        </div>
    </section>
{% endblock %}

{% block javascripts %}

    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.js"></script>
    <script src="{{ asset('assets/js/swiper.min.js') }}"></script>
    <script>
        var galleryThumbs = new Swiper('.gallery-thumbs', {
            spaceBetween: 10,
            slidesPerView: 4,
            loop: true,
            freeMode: true,
            loopedSlides: 5,
            watchSlidesVisibility: true,
            watchSlidesProgress: true,
        });
        var galleryTop = new Swiper('.gallery-top', {
            spaceBetween: 10,
            loop: true,
            loopedSlides: 5,
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            thumbs: {
                swiper: galleryThumbs,
            },
            keyboard: {
                enabled: true,
            }
        });

        var initPhotoSwipeFromDOM = function(gallerySelector) {
            // parse slide data (url, title, size ...) from DOM elements
            // (children of gallerySelector)
            var parseThumbnailElements = function(el) {
                var thumbElements = el.childNodes,
                    numNodes = thumbElements.length,
                    items = [],
                    figureEl,
                    linkEl,
                    size,
                    item;

                for (var i = 0; i < numNodes; i++) {
                    figureEl = thumbElements[i]; // <figure> element

                    // include only element nodes
                    if (figureEl.nodeType !== 1) {
                        continue;
                    }

                    linkEl = figureEl.children[0]; // <a> element

                    size = linkEl.getAttribute("data-size").split("x");

                    // create slide object
                    item = {
                        src: linkEl.getAttribute("href"),
                        w: parseInt(size[0], 10),
                        h: parseInt(size[1], 10)
                    };

                    if (figureEl.children.length > 1) {
                        // <figcaption> content
                        item.title = figureEl.children[1].innerHTML;
                    }

                    if (linkEl.children.length > 0) {
                        // <img> thumbnail element, retrieving thumbnail url
                        item.msrc = linkEl.children[0].getAttribute("src");
                    }

                    item.el = figureEl; // save link to element for getThumbBoundsFn
                    items.push(item);
                }

                return items;
            };

            // find nearest parent element
            var closest = function closest(el, fn) {
                return el && (fn(el) ? el : closest(el.parentNode, fn));
            };

            // triggers when user clicks on thumbnail
            var onThumbnailsClick = function(e) {
                e = e || window.event;
                e.preventDefault ? e.preventDefault() : (e.returnValue = false);

                var eTarget = e.target || e.srcElement;

                // find root element of slide
                var clickedListItem = closest(eTarget, function(el) {
                    return el.tagName && el.tagName.toUpperCase() === "LI";
                });

                if (!clickedListItem) {
                    return;
                }

                // find index of clicked item by looping through all child nodes
                // alternatively, you may define index via data- attribute
                var clickedGallery = clickedListItem.parentNode,
                    childNodes = clickedListItem.parentNode.childNodes,
                    numChildNodes = childNodes.length,
                    nodeIndex = 0,
                    index;

                for (var i = 0; i < numChildNodes; i++) {
                    if (childNodes[i].nodeType !== 1) {
                        continue;
                    }

                    if (childNodes[i] === clickedListItem) {
                        index = nodeIndex;
                        break;
                    }
                    nodeIndex++;
                }

                if (index >= 0) {
                    // open PhotoSwipe if valid index found
                    openPhotoSwipe(index, clickedGallery);
                }
                return false;
            };

            // parse picture index and gallery index from URL (#&pid=1&gid=2)
            var photoswipeParseHash = function() {
                var hash = window.location.hash.substring(1),
                    params = {};

                if (hash.length < 5) {
                    return params;
                }

                var vars = hash.split("&");
                for (var i = 0; i < vars.length; i++) {
                    if (!vars[i]) {
                        continue;
                    }
                    var pair = vars[i].split("=");
                    if (pair.length < 2) {
                        continue;
                    }
                    params[pair[0]] = pair[1];
                }

                if (params.gid) {
                    params.gid = parseInt(params.gid, 10);
                }

                return params;
            };

            var openPhotoSwipe = function(
                index,
                galleryElement,
                disableAnimation,
                fromURL
            ) {
                var pswpElement = document.querySelectorAll(".pswp")[0],
                    gallery,
                    options,
                    items;

                items = parseThumbnailElements(galleryElement);

                options = {

                    closeEl: true,
                    captionEl: true,
                    fullscreenEl: true,
                    zoomEl: true,
                    shareEl: false,
                    counterEl: false,
                    arrowEl: true,
                    preloaderEl: true,

                    galleryUID: galleryElement.getAttribute("data-pswp-uid"),
                    getThumbBoundsFn: function(index) {

                        var thumbnail = items[index].el.getElementsByTagName("img")[0],
                            pageYScroll =
                                window.pageYOffset || document.documentElement.scrollTop,
                            rect = thumbnail.getBoundingClientRect();

                        return { x: rect.left, y: rect.top + pageYScroll, w: rect.width };
                    }
                };

                if (fromURL) {
                    if (options.galleryPIDs) {
                        for (var j = 0; j < items.length; j++) {
                            if (items[j].pid == index) {
                                options.index = j;
                                break;
                            }
                        }
                    } else {

                        options.index = parseInt(index, 10) - 1;
                    }
                } else {
                    options.index = parseInt(index, 10);
                }

                if (isNaN(options.index)) {
                    return;
                }

                if (disableAnimation) {
                    options.showAnimationDuration = 0;
                }


                gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
                gallery.init();

                /* EXTRA CODE (NOT FROM THE CORE) - UPDATE SWIPER POSITION TO THE CURRENT ZOOM_IN IMAGE (BETTER UI) */

                // photoswipe event: Gallery unbinds events
                // (triggers before closing animation)
                gallery.listen("unbindEvents", function() {
                    // This is index of current photoswipe slide
                    var getCurrentIndex = gallery.getCurrentIndex();
                    // Update position of the slider
                    mySwiper.slideTo(getCurrentIndex, false);
                });
            };

            // loop through all gallery elements and bind events
            var galleryElements = document.querySelectorAll(gallerySelector);

            for (var i = 0, l = galleryElements.length; i < l; i++) {
                galleryElements[i].setAttribute("data-pswp-uid", i + 1);
                galleryElements[i].onclick = onThumbnailsClick;
            }

            // Parse URL and open gallery if it contains #&pid=3&gid=1
            var hashData = photoswipeParseHash();
            if (hashData.pid && hashData.gid) {
                openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true);
            }
        };

        // execute above function
        initPhotoSwipeFromDOM(".my-gallery");


    </script>

    <script>
        $('#make-filter').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
            $.post('{{ path('api_fetchModelByMake') }}', {make: this.value})
                .done(function (data) {
                    $('#model-select').empty();
                    data.forEach((element) => {
                        $('#model-select').append(`<option value="${element.model.toLowerCase()}">${element.model}</option>`);
                    });

                })
        });
    </script>
{% endblock %}