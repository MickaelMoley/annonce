{% extends 'base.html.twig' %}
{% block head %}
    {{ parent() }}

{% endblock %}
{% block title %} Site d'annonces auto {% endblock %}

{% block stylesheets %}

    <style>
        .swiper-container {
            width: 100%;
            height: 8rem;
            margin-left: auto;
            margin-right: auto;
        }

        .swiper-slide {
            background-size: cover;
            background-position: center;
        }

        .gallery-top {
            height: 250px;
            width: 100%;
        }

        .gallery-thumbs {
            height: 100px;
            box-sizing: border-box;
            padding: 10px 0;
        }

        @media (min-width: 768px) {
            .gallery-top {
                height: 350px;
                width: 100%;
            }

            .gallery-thumbs {
                height: 150px;
                box-sizing: border-box;
                padding: 10px 0;
            }
        }

        .gallery-thumbs .swiper-slide {
            height: 100%;
            opacity: 0.4;
        }

        .gallery-thumbs .swiper-slide-thumb-active {
            opacity: 1;
        }
    </style>

{% endblock %}

{% block body %}

    <div class="wrapper">
        <div class="d-none d-lg-block" id="path">
            <div class="container">
                <div class="row">
                    <div class="col">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="#"><span>Accueil</span></a></li>
                            <li class="breadcrumb-item"><a href="#"><span>Chercher une annonce</span></a></li>

                            <li class="breadcrumb-item"><a href="{{ path('annonces', {'make': annonce.make|lower}) }}"
                                                           class="text-info"><span>{{ annonce.make|lower }}</span></a>
                            </li>
                            <li class="breadcrumb-item"><a
                                        href="{{ path('annonces', {'model': annonce.model|lower }) }}"
                                        class="text-info"><span>{{ annonce.model|lower }}</span></a></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-12 col-lg-8">
                        <div class="bg-white shadow-sm d-lg-none mb-3 p-3 sticky-top" id="meta-mobile-sticky-top">
                            <div class="row">
                                <div class="col-4">
                                    <img class="img-fluid" src="{{ annonce.image[0].url[0] }}">
                                </div>
                                <div class="col-8">
                                    <h2 class="meta-mobile-title">{{ annonce.title }}</h2><span
                                            class="text-info text-primary font-weight-bold">{{ annonce.price | number_format(2,'.',',') }} €</span>
                                </div>
                            </div>
                        </div>
                        <div class="swiper-container gallery-top" id="annonce-collection-image">
                            <div class="swiper-wrapper">
                                {% for image in annonce.image %}
                                    <div class="swiper-slide" style="background-image:url({{ image.url[0] }})"></div>
                                {% endfor %}
                            </div>
                            <!-- Add Arrows -->
                            <div class="swiper-button-next swiper-button-white"></div>
                            <div class="swiper-button-prev swiper-button-white"></div>
                        </div>
                        <div class="swiper-container gallery-thumbs">
                            <div class="swiper-wrapper">
                                {% for image in annonce.image %}
                                    <div class="swiper-slide" style="background-image:url({{ image.url[0] }})"></div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="border rounded shadow-sm mb-3 p-3" id="meta">
                            <h1 class="annonce-title">{{ annonce.title }}</h1>
                            <span class="text-info text-primary font-weight-bold">{{ annonce.price | number_format(2,'.',',') }} €</span>
                        </div>
                        <div id="caracteristique" class="mb-3">
                            <div class="card">
                                <div class="card-header d-flex justify-content-start align-items-center">
                                    <h3 class="card-title">Caractéristiques</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12 col-lg-6">
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item d-flex justify-content-between">
                                                    <span class="text-primary"><i class="fas fa-car-side mr-2"></i>Catégorie</span><span>{{ annonce.bodyStyle }}</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i
                                                                class="fas fa-car mr-2"></i>Marque</span><span
                                                            class="text-muted">{{ annonce.make }}</span></li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i
                                                                class="fas fa-car-alt mr-2"></i>Modèle</span><span>{{ annonce.model }}</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i class="fas fa-hashtag mr-2"></i>Référence</span><span>{{ annonce.vehicleId }}</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between">
                                                    <span class="text-primary">
                                                        <i class="fas fa-calendar-day mr-2"></i>Mise en circulation&nbsp;</span><span>{{ annonce.year }}</span>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="col-12 col-lg-6">
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i class="fas fa-gas-pump mr-2"></i>Carburant&nbsp;</span><span>{{ annonce.fuelType }}</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i class="fas fa-road mr-2"></i>Kilométrage</span><span>{{ annonce.mileage['value'] | number_format(0,'',' ') }} km</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i
                                                                class="fas fa-cog mr-2"></i>Boîte</span><span>{{ annonce.transmission }}</span>
                                                </li>
                                                <li class="list-group-item d-flex justify-content-between"><span
                                                            class="text-primary"><i class="fas fa-palette mr-2"></i>Couleur extérieur</span><span>{{ annonce.exteriorColor }}</span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="divers">
                            <ul class="nav nav-tabs">
                                <li class="nav-item"><a class="nav-link active" role="tab" data-toggle="tab"
                                                        href="#description">Description</a></li>
                                <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab" href="#options">Options</a>
                                </li>
                                <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab"
                                                        href="#note">Note du vendeur</a></li>
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane active p-3" role="tabpanel" id="description">
                                    <p class="text-primary">{{ annonce.description | raw }}</p>
                                </div>
                                <div class="tab-pane p-3" role="tabpanel" id="options">
                                    <div class="row">
                                        {% set currentFeature = 0 %}
                                        {% set limitPerColumn = 15 %}

                                        {% for feature in annonce.features %}
                                            {% if currentFeature == 0 %}
                                                <div class="col-12 col-md-6 col-lg-4">
                                                <ul class="list-unstyled text-primary p-3">
                                            {% endif %}
                                            <li><i class="fas fa-check mr-2"></i>{{ feature }}</li>
                                            {% set currentFeature = currentFeature + 1 %}
                                            {% if currentFeature >= limitPerColumn %}
                                                {% set currentFeature = 0 %}
                                                </ul>
                                                </div>
                                            {% endif %}

                                        {% endfor %}

                                    </div>
                                </div>
                                <div class="tab-pane p-3" role="tabpanel" id="note">
                                    <p class="text-primary">Le vendeur n'a pas laissé de note. Utiliser le formulaire de
                                        contact pour en savoir plus.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-4">
                        <div class="card text-primary bg-secondary border-1">
                            <div class="card-header border-primary">
                                <div class="media"><img class="rounded-circle mr-3 img-fluid"
                                                        src="https://www.vroomiz.fr/bundles/vrzfront/front/img/logo.png"
                                                        width="50rem"/>
                                    <div class="media-body">
                                        <h5>{{ annonce.dealerName }}</h5>
                                        <a href="#">
                                            <i class="fas fa-map-marker-alt mr-2"></i>Fay aux Loges
                                        </a></div>
                                </div>
                                <br>
                                <div class="d-flex align-items-center">
                                    <div class="px-4 py-3" style="background-color: #eceeef;"><i class="fas fa-phone"
                                                                                                 style="color: #55595c;"></i>
                                    </div>
                                    <div class="d-flex justify-content-center px-4 py-3 w-100"
                                         style="background-color: #eceeef;"><a href="tel:"
                                                                               style="color: #55595c;">{{ annonce.dealerPhone }}</a>
                                    </div>
                                </div>

                                <hr/>
                                <div class="card-body">
                                    <form>
                                        <div class="form-group"><label>Email</label><input type="email"
                                                                                           class="form-control"/></div>
                                        <div class="form-group"><label>Téléphone</label><input type="tel"
                                                                                               class="form-control"/>
                                        </div>
                                        <div class="form-group"><label>Email</label><textarea class="form-control"
                                                                                              placeholder="Je suis intéressé par ce véhicule. Pouvez-vous me contacter afin de convenir d&#39;un rendez-vous ?"
                                                                                              rows="6">Je suis intéressé par ce véhicule. Pouvez-vous me contacter afin de convenir d&#39;un rendez-vous ?</textarea>
                                            <small
                                                    class="form-text text-muted">Uniquement par particulier
                                            </small>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-block btn-custom-primary" type="button"><i
                                                        class="fas fa-envelope mr-2"></i>Envoyer un message
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        var galleryThumbs = new Swiper('.gallery-thumbs', {
            spaceBetween: 10,
            slidesPerView: 4,
            loop: true,
            freeMode: true,
            loopedSlides: 5, //looped slides should be the same
            watchSlidesVisibility: true,
            watchSlidesProgress: true,
        });
        var galleryTop = new Swiper('.gallery-top', {
            spaceBetween: 10,
            loop: true,
            loopedSlides: 5, //looped slides should be the same
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            thumbs: {
                swiper: galleryThumbs,
            },
        });
    </script>
{% endblock %}